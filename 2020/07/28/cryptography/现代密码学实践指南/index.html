<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>现代密码学实践指南[2015年] | Jeremie&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="现代密码学实践指南[2015年] 本文介绍目前现代密码学的最先进技术，前半部分主要翻译自  《Cryptographic Right Answers》 ，附上收集的资料，和byron个人的理解。 密码学理论艰深，概念繁多，本人知识水平有限，错误难免，如果您发现错误，请务必指出，非常感谢!    下文分类介绍在各种适用场景下，你应该使用的现代密码学算法1.  加密数据 :按照优先级，应该选择:(1)">
<meta property="og:type" content="article">
<meta property="og:title" content="现代密码学实践指南[2015年]">
<meta property="og:url" content="http://hexo.jeremie.moe/2020/07/28/cryptography/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="Jeremie&#39;s Blog">
<meta property="og:description" content="现代密码学实践指南[2015年] 本文介绍目前现代密码学的最先进技术，前半部分主要翻译自  《Cryptographic Right Answers》 ，附上收集的资料，和byron个人的理解。 密码学理论艰深，概念繁多，本人知识水平有限，错误难免，如果您发现错误，请务必指出，非常感谢!    下文分类介绍在各种适用场景下，你应该使用的现代密码学算法1.  加密数据 :按照优先级，应该选择:(1)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hexo.jeremie.moe/images/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.png">
<meta property="article:published_time" content="2020-07-28T08:29:01.000Z">
<meta property="article:modified_time" content="2020-07-28T09:23:04.523Z">
<meta property="article:author" content="Jeremie">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hexo.jeremie.moe/images/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.png">
  
    <link rel="alternate" href="/atom.xml" title="Jeremie&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jeremie&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives/">归档</a>
        
          <a class="main-nav-link" href="/about-blog/">关于Blog</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://hexo.jeremie.moe"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-cryptography/现代密码学实践指南" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/28/cryptography/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/" class="article-date">
  <time datetime="2020-07-28T08:29:01.000Z" itemprop="datePublished">2020-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      现代密码学实践指南[2015年]
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="现代密码学实践指南-2015年"><a href="#现代密码学实践指南-2015年" class="headerlink" title="现代密码学实践指南[2015年]"></a>现代密码学实践指南[2015年]</h1><hr>
<p>本文介绍目前现代密码学的最先进技术，<br>前半部分主要翻译自  <a target="_blank" rel="noopener" href="https://gist.github.com/tqbf/be58d2d39690c3b366ad">《Cryptographic Right Answers》</a> ，附上收集的资料，和byron个人的理解。</p>
<p>密码学理论艰深，概念繁多，本人知识水平有限，错误难免，如果您发现错误，请务必指出，非常感谢!  </p>
<hr>
<h3 id="下文分类介绍在各种适用场景下，你应该使用的现代密码学算法"><a href="#下文分类介绍在各种适用场景下，你应该使用的现代密码学算法" class="headerlink" title="下文分类介绍在各种适用场景下，你应该使用的现代密码学算法"></a>下文分类介绍在各种适用场景下，你应该使用的现代密码学算法</h3><h3 id="1-加密数据"><a href="#1-加密数据" class="headerlink" title="1.  加密数据 :"></a>1.  <strong>加密数据</strong> :</h3><p>按照优先级，应该选择:<br>(1)   首选 NaCl库，或者libsodium库，使用里面的<code>crypto_secretbox()</code>/<code>crypto_secretbox_open()</code> 函数<br>(2)   Chacha20-Poly1305 算法<br>(3)   AES-GCM 算法 </p>
<p>适用场景:当你需要避免把明文数据在网络上传输的时候。</p>
<p>以上3种算法，都是AEAD类的算法，AEAD是2015年最好的选择。<br>其中的(2)和(3)在结构上类似：一个流加密模式的算法，配合一个多项式结构的MAC。<br>(2)是一个流加密算法，配合一个为通用cpu优化的MAC算法，<br>对密码学库的实现者来说，Poly1305也比GCM更容易安全地实现。<br>AES-GCM是工业标准(TLS目前主要用的就是AES-GCM)，现代CPU通常都有专门为AES-GCM设计的硬件指令，但是在没有硬件指令支持的CPU上(比如32位的arm)，(3)性能低于(2)。 </p>
<p>此外，应该</p>
<ul>
<li>避免AES-CBC</li>
<li>避免AES-CTR</li>
<li>避免64bit块大小的块加密算法–(说的就是你–BlowFish)</li>
<li>避免OFB模式</li>
<li>不要使用RC4，RC4已经被攻破</li>
</ul>
<h3 id="2-对称密钥长度"><a href="#2-对称密钥长度" class="headerlink" title="2.  对称密钥长度 :"></a>2.  <strong>对称密钥长度</strong> :</h3><p>选择使用256bit长度的密钥</p>
<p>适用场景：只要你在使用密码学，你就应该注意<strong>对称密钥长度</strong></p>
<p>请记住：不要把对称加密（如AES）的key长度，和非对称加密(如RSA)的key长度搞混淆了，对称加密的key通常比非对称加密的key短多了。</p>
<p>下表对比了相同安全程度时，不同算法的密钥长度，单位:bit</p>
<table>
<thead>
<tr>
<th>Symmetric</th>
<th>ECC</th>
<th>DH/DSA/RSA</th>
</tr>
</thead>
<tbody><tr>
<td>80</td>
<td>163</td>
<td>1024</td>
</tr>
<tr>
<td>112</td>
<td>233</td>
<td>2048</td>
</tr>
<tr>
<td>128</td>
<td>283</td>
<td>3072</td>
</tr>
<tr>
<td>192</td>
<td>409</td>
<td>7680</td>
</tr>
<tr>
<td>256</td>
<td>571</td>
<td>15360</td>
</tr>
</tbody></table>
<p>此外，应该</p>
<ul>
<li> 避免使用巨大key的算法(使用远大于256的key，只能说明使用者没有安全概念)</li>
<li> 避免把多个加密算法串联叠加起来使用，这并没有什么卵用</li>
<li> 避免128bit以下的key长度(比如，哥们求你别再提DES这种56bit密钥的古董了)</li>
</ul>
<h3 id="3-对称签名"><a href="#3-对称签名" class="headerlink" title="3.  对称签名:"></a>3.  <strong>对称签名</strong>:</h3><p>应该选择 HMAC 类的算法</p>
<p>适用场景：安全加固一个API，如各种开放API的调用方认证</p>
<p>如果对一个API，你需要做认证(authenticating)，但是不需要做加密(encrypting)，记得千万不要自己发明算法，你自己发明的MAC算法基本都有安全漏洞，如果不信，请Google一下 “长度扩展攻击”<br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Length_extension_attack">长度扩展攻击</a><br><a target="_blank" rel="noopener" href="http://netifera.com/research/flickr_api_signature_forgery.pdf">Flickr的漏洞案例</a></p>
<p>同时，必须要注意的是，要使用一个<strong>常数时间字符串对比算法</strong>（这个地方和码农的常识完全相反，请务必留意）</p>
<p>此外，应该</p>
<ul>
<li> 避免自行设计的“带密码的hash”结构，你的设计基本都是有安全漏洞的</li>
<li> 避免HMAC-MD5，避免HMAC-SHA1，使用HMAC-SHA256, HMAC-SHA512等</li>
<li> 避免复杂的多项式MAC</li>
<li> 避免加密hash值的结构</li>
<li> 避免CRC</li>
</ul>
<h3 id="4-Hashing-HMAC-算法"><a href="#4-Hashing-HMAC-算法" class="headerlink" title="4.  Hashing/HMAC 算法"></a>4.  <strong>Hashing/HMAC 算法</strong></h3><p>应该选择 <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/SHA-2">SHA2</a> 类的算法:: SHA-256, SHA-384, SHA-512, SHA-512/256</p>
<p>优先使用 SHA-512/256，SHA-512/256这个算法把 SHA-512 的512bit输出截短到256bit，避开了length extension 攻击。<br>同时，目前SHA-2是很安全可靠的，你不需要升级到SHA-3. </p>
<p>此外，应该</p>
<ul>
<li> 避免SHA-1</li>
<li> 避免MD5</li>
<li> 避免MD6</li>
</ul>
<h3 id="5-随机ID"><a href="#5-随机ID" class="headerlink" title="5.  随机ID"></a>5.  <strong>随机ID</strong></h3><p>应该使用256 bit的随机值</p>
<p>一定要使用 /dev/urandom，请认准这个</p>
<p>此外，应该 </p>
<ul>
<li> 避免用户空间的随机数生成器如:havaged,prngs,egd,等</li>
<li> 避免/dev/random</li>
</ul>
<h3 id="6-密码处理"><a href="#6-密码处理" class="headerlink" title="6.  密码处理"></a>6.  <strong>密码处理</strong></h3><p>按照优先级顺序,选择： </p>
<ul>
<li> scrypt</li>
<li> bcrypt</li>
<li> 如果以上2个都没有，那就用PBKDF2</li>
</ul>
<p>此外，应该 </p>
<ul>
<li> 避免直接SHA-2</li>
<li> 避免直接SHA-1</li>
<li> 避免直接MD5</li>
</ul>
<h3 id="7-非对称加密"><a href="#7-非对称加密" class="headerlink" title="7.  非对称加密"></a>7.  <strong>非对称加密</strong></h3><p>应该使用NaCl库</p>
<p>适用场景：当你需要加密消息，发给陌生人，并且对方异步接收消息，做离线解密时。这是一个很窄的应用案例，这种用法有个名字叫*电子信封(digital envelope)*，典型比如gpg加密文件后发送。</p>
<p>这条是几条之中最难做正确的，不要使用底层的密码学库，比如OpenSSL或者BouncyCastle。</p>
<p>你应该停止使用RSA，并且切换到椭圆曲线类体制，原因是：</p>
<ul>
<li>对RSA的攻击能力的进步 — 定义在传统质数域上的乘法运算(应用包括DH,DSA,ElGamal等)，要比椭圆曲线域上的乘法运算快得多。这是由于质数域上数域筛法（number field sieve,NFS）的进展，而在椭圆曲线域上，没有NFS这类算法。</li>
<li>RSA (和DH) 或迫使你考虑“向后兼容性”，而椭圆曲线体制没有这种兼容性包袱。TLS最近的几个安全漏洞，部分原因也是由于这种向后兼容性，导致已经被破解的陈旧算法存在</li>
<li>RSA在一般场景中，都是直接用公钥做非对称加密，这种用法丧失了**前向安全性(Perfect Forward Secrecy)**。而椭圆曲线就不提倡，也很难这样使用，这样你就不会害死自己了。</li>
<li>在椭圆曲线体制下，保证正确性和安全性的重任，主要由密码学家承担，密码学家会提供一组曲线参数，在某一性能水平下，针对安全性和性能做优化。这样程序员不容易误用而害死自己。在RSA体制下，正好相反，程序员必须提供参数来保证正确性和安全性，就算是RSA-OAEP这种很好的设计，程序员也必须知道怎么提供参数，这样程序员很容易搞错。</li>
</ul>
<p>如果你必须使用RSA，一定要使用RSA-OAEP with SHA256，指数使用 65537</p>
<ul>
<li> 避免 RSA-PKCS1v15</li>
<li> 避免 ElGamal</li>
<li> 避免 RSA</li>
</ul>
<h3 id="8-非对称签名"><a href="#8-非对称签名" class="headerlink" title="8.  非对称签名"></a>8.  <strong>非对称签名</strong></h3><p>应该使用NaCl，Ed25519，或者RFC6979</p>
<p>应用场景：如果你在设计一种新的比特币，或者一个给Ruby Gems或者Vagrant imges文件签名的系统，或者数字版权保护系统(DRM)，其中一系列的文件需要离线做认证；<br>或者你在设计一个加密消息传输层 </p>
<p>上一条的内容在此处全部适用。</p>
<p>在10+年做付费软件安全评估的工作经历中，我只有屈指可数的几次，遇到使用RSA-PSS的用户，RSA-PSS是一个学术界的推荐算法。 </p>
<p>过去10年，非对称签名最主要的应用场景是比特币，和前向安全的密钥协商（TLS协议里面的ECDHE）。<br>其中最主要的算法全都是基于椭圆曲线体制的。务必警惕新出现的使用RSA签名的系统，很有可能有问题。 </p>
<p>在过去几年中，业界有一种趋势：放弃传统DSA签名，改为难以误用的<strong>确定性签名体制</strong>，其中的EdDSA(不要和ECDSA搞混了喂！)和RFC6979是最好的例子。<br>这种趋势的主要是受到2010年索尼PlayStation 3的 ECDSA私钥被破解事件的影响，在这个案例中，索尼公司的码农错误地把一个随机数重复使用来做ECDSA签名，形成了漏洞，使得破解者据此直接把私钥算出来了。<br><strong>确定性签名体制</strong>在设计中不再依赖随机数生成器，因此彻底避开此类误用。所以你应该优先使用确定性签名体制。</p>
<ul>
<li> 避免RSA-PKCS1v15，避免RSA，避免ECDSA，避免DSA</li>
<li> 特别要避免常规的DSA和ECDSA</li>
</ul>
<h3 id="9-Diffie-Hellman-密钥交换"><a href="#9-Diffie-Hellman-密钥交换" class="headerlink" title="9.  Diffie-Hellman 密钥交换"></a>9.  <strong>Diffie-Hellman 密钥交换</strong></h3><p>应该使用NaCl，Curve25519，或者DH-2048</p>
<p>适用场景:<em>如果你在设计加密消息传输系统，并且无法使用固定对称密码</em></p>
<p>这是很棘手的一条，主要考量如下：</p>
<ul>
<li>如果你能使用NaCl库，那就使用NaCl库。你甚至不需要管NaCl是什么。</li>
<li>如果你能使用一个可信赖的第三方库，那就使用Curve25519，这是一条现代的ECDH曲线，有丰富的开源代码，性能经过高度优化，被彻底地安全分析过。并且Curve25519即将进入TLS 1.3版本标准。</li>
<li>但是绝对不要自己实现Curve25519，也绝对不要自己移植Curve25519的C代码</li>
<li>如果你不能使用第三方ECDH库，但是可以使用DH库，那就使用DH-2048，使用1个标准的2048 bit的群。</li>
<li>但是不要使用传统的DH，如果你需要协商DH参数，或者和其他实现互操作</li>
<li>如果你一定要做握手协商，或者和旧软件互操作，那么考虑使用NIST P-256, NIST P-256 有广泛的软件支持。</li>
<li>写死在代码里的DH-2048参数，比NIST P-256更安全。NIST P-256比协商出来的DH更安全。</li>
<li>但是，由于NIST P-256的实现有一些陷阱，所以一定要谨慎选择可信赖的，广泛使用使的第三方库</li>
<li>P-256 可能是NIST曲线中最安全的，不要使用P-224。</li>
</ul>
<p>DH（密钥协商）算法确实很难用，但是它很重要。</p>
<ul>
<li> 避免，传统常规的 DH, SRP, J-PAKE 握手和协商</li>
<li> 避开任何只使用了块加密算法和<code>srand(time())</code>的密钥协商模式（肯定有漏洞）</li>
</ul>
<h3 id="10-网站安全"><a href="#10-网站安全" class="headerlink" title="10.  网站安全"></a>10.  <strong>网站安全</strong></h3><p>应该使用OpenSSL，或者Google的BoringSSL，或者直接使用 AWS的 ELB</p>
<p>此处网站安全，指的是让网站支持HTTPS协议。<br>如果你不能把这个任务交给Amazon的云服务去做，把难题留给Amazon去解决，那么OpenSSL目前仍然是正确选择。</p>
<ul>
<li> 避免不常见的TLS库，例如polarssl，GnuTLS，MatrixSSL等</li>
</ul>
<h3 id="11-客户端-服务器结构的应用程序的安全："><a href="#11-客户端-服务器结构的应用程序的安全：" class="headerlink" title="11.  客户端-服务器结构的应用程序的安全："></a>11.  <strong>客户端-服务器结构的应用程序的安全</strong>：</h3><p>应该使用TLS</p>
<p>适用场景：如果你以为自己理解了前面关于公钥加密的介绍。。。</p>
<p>通常，在你设计了自己的RSA协议之后的1至18个月，你肯定会发现，你犯了某个错误，使你的协议没有任何安全性。<br>比如Salt Stack，Salt Stack的协议使用了 e=1 的RSA 公钥。。。 </p>
<p>听起来，TLS有下面这些黑历史：</p>
<ul>
<li>The Logjam DH negotiation attack</li>
<li>The FREAK export cipher attack</li>
<li>The POODLE CBC oracle attack</li>
<li>The RC4 fiasco</li>
<li>The CRIME compression attack</li>
<li>The Lucky13 CBC padding oracle timing attack</li>
<li>The BEAST CBC chained IV attack</li>
<li>Heartbleed</li>
<li>Renegotiation</li>
<li>Triple Handshakes</li>
<li>Compromised CAs</li>
</ul>
<p>但是，你仍然应该使用TLS做传输协议，因为： </p>
<ul>
<li>这些漏洞中的大部分，仅仅是针对浏览器的，因为他们依赖受害者执行攻击者控制的JavaScript脚本，这些JavaScript脚本生成重复的明文，或特定的明文。</li>
<li>这些漏洞中的大部分，其影响都可以被减轻，只需要你在代码和配置里面写死 TLS v1.2, ECDHE，和 AES-GCM就行。这听起来很棘手，但是这远远没有你自己设计使用ECDHE和AES-GCM的传输协议棘手。</li>
<li>在一个自定义的传输协议的场景中，你并不需要依赖CA，你可以用一个自签名证书，嵌入到你的客户端里面。</li>
</ul>
<ul>
<li> 不要自己设计加密传输协议，这是<strong>极其困难而易错的工程难题</strong></li>
<li> 使用TLS，但是不要使用默认配置</li>
</ul>
<h3 id="12-在线备份"><a href="#12-在线备份" class="headerlink" title="12.  在线备份"></a>12.  <strong>在线备份</strong></h3><p>应该使用Tarsnap</p>
<hr>
<h1 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h1><p>本文的内容比较新，相关中文资料极少，因此文中的名词对读者可能有点陌生，故byron这里介绍一下文中提到的一些名词：</p>
<h5 id="1-NaCl库"><a href="#1-NaCl库" class="headerlink" title="1. NaCl库:"></a>1. NaCl库:</h5><p><a target="_blank" rel="noopener" href="http://nacl.cr.yp.to/">http://nacl.cr.yp.to/</a><br>是密码学学术权威 Daniel J. Bernstein教授 设计的一个密码学算法库，2008年发开始公布。<br>NaCl的特点是：api简洁而易用，高性能，高安全性，主要用于网络通信，加密，解密，签名等，NaCl提供了构建高层密码学工具的核心功能。  </p>
<h5 id="2-libsodium库"><a href="#2-libsodium库" class="headerlink" title="2. libsodium库:"></a>2. libsodium库:</h5><p><a target="_blank" rel="noopener" href="https://download.libsodium.org/doc/">https://download.libsodium.org/doc/</a><br>libsodium是对NaCl库的一个分支，进一步改进接口易用性，和可移植性。  </p>
<h5 id="3-AEAD"><a href="#3-AEAD" class="headerlink" title="3. AEAD:"></a>3. AEAD:</h5><p><a target="_blank" rel="noopener" href="https://www.imperialviolet.org/2014/02/27/tlssymmetriccrypto.html">https://www.imperialviolet.org/2014/02/27/tlssymmetriccrypto.html</a><br>AEAD的概念: 在通常的密码学应用中，Confidentiality (保密) 用加密实现，Message authentication (消息认证) 用MAC实现。<br>这两种算法的配合方式，引发了很多安全漏洞，过去曾经有3种方法：1. Encrypt-and-MAC 2.MAC-then-Encrypt 3.Encrypt-then-MAC ，后来发现，1和2都是有安全问题的，所以，2008年起， 逐渐提出了“用一个算法在内部同时实现cipher+MAC”的idea，称为AEAD(Authenticated encryption with additional data)。<br>在AEAD这种概念里，cipher+MAC 被 一个AEAD算法替换。<br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Authenticated_encryption">http://en.wikipedia.org/wiki/Authenticated_encryption</a>  </p>
<h5 id="4-ChaCha20-poly1305"><a href="#4-ChaCha20-poly1305" class="headerlink" title="4. ChaCha20-poly1305"></a>4. ChaCha20-poly1305</h5><p>ChaCha20-poly1305是一种AEAD，提出者是Daniel J. Bernstein教授，针对移动互联网优化，目前Google对移动客户端的所有流量都使用ChaCha20-Poly1305</p>
<h5 id="5-AES-GCM"><a href="#5-AES-GCM" class="headerlink" title="5. AES-GCM"></a>5. AES-GCM</h5><p>AES-GCM是一种AEAD，是目前TLS的主力算法，互联网上https流量的大部分依赖使用AES-GCM。</p>
<h5 id="6-AES-GCM和ChaCha20-Poly1305的性能对比测试结果"><a href="#6-AES-GCM和ChaCha20-Poly1305的性能对比测试结果" class="headerlink" title="6. AES-GCM和ChaCha20-Poly1305的性能对比测试结果:"></a>6. AES-GCM和ChaCha20-Poly1305的性能对比测试结果:</h5><table>
<thead>
<tr>
<th>Chip</th>
<th>AES-128-GCM  speed</th>
<th>ChaCha20-Poly1305  speed</th>
</tr>
</thead>
<tbody><tr>
<td>OMAP 4460</td>
<td>24.1 MB/s</td>
<td>75.3 MB/s</td>
</tr>
<tr>
<td>Snapdragon S4 Pro</td>
<td>41.5 MB/s</td>
<td>130.9 MB/s</td>
</tr>
<tr>
<td>Sandy Bridge Xeon (AESNI)</td>
<td>900 MB/s</td>
<td>500 MB/s</td>
</tr>
</tbody></table>
<h5 id="7-AES-CBC"><a href="#7-AES-CBC" class="headerlink" title="7. AES-CBC"></a>7. AES-CBC</h5><p>关于AES-CBC，在AES-GCM流行之前，TLS主要依赖AES-CBC，而由于历史原因，TLS在设计之初固定选择了MAC-then-Encrypt结构，AES-CBC和MAC-then-encrypt结合，为选择密文攻击(CCA)创造了便利条件，TLS历史上有多个漏洞都和CBC模式有关：</p>
<ul>
<li>The POODLE CBC oracle attack:参考: <a target="_blank" rel="noopener" href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">1.POODLE的一个分析</a> <a target="_blank" rel="noopener" href="https://www.openssl.org/~bodo/tls-cbc.txt">2.openssl的分析</a> <a target="_blank" rel="noopener" href="http://drops.wooyun.org/papers/3194">3.乌云的文章</a></li>
<li>The CRIME compression attack:</li>
<li>The Lucky13 CBC padding oracle timing attack:</li>
<li>The BEAST CBC chained IV attack:</li>
</ul>
<h5 id="8-SHA2"><a href="#8-SHA2" class="headerlink" title="8. SHA2"></a>8. SHA2</h5><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/SHA-2">http://en.wikipedia.org/wiki/SHA-2</a></p>
<h5 id="9-Curve25519"><a href="#9-Curve25519" class="headerlink" title="9. Curve25519"></a>9. Curve25519</h5><p><a target="_blank" rel="noopener" href="http://cr.yp.to/ecdh.html">http://cr.yp.to/ecdh.html</a><br>Curve25519 是目前最高水平的 Diffie-Hellman函数，适用于广泛的场景，由Daniel J. Bernstein教授设计。<br>由于NIST P-256的设计过程不透明，有来历不明的参数，被广泛怀疑有后门，所以设计了Curve25519，Curve25519的设计过程完全公开，没有任何来历不明的参数。<br>部署情况：<a target="_blank" rel="noopener" href="http://ianix.com/pub/curve25519-deployment.html">http://ianix.com/pub/curve25519-deployment.html</a>  </p>
<h5 id="10-Ed25519"><a href="#10-Ed25519" class="headerlink" title="10. Ed25519"></a>10. Ed25519</h5><p><a target="_blank" rel="noopener" href="http://ed25519.cr.yp.to/">http://ed25519.cr.yp.to/</a><br>Ed25519是一个数字签名算法，  </p>
<ul>
<li>签名和验证的性能都极高， 一个4核2.4GHz 的 Westmere cpu，每秒可以验证 71000 个签名</li>
<li>安全性极高，等价于RSA约3000-bit</li>
<li>签名过程不依赖随机数生成器，不依赖hash函数的防碰撞性，没有时间通道攻击的问题</li>
<li>并且签名很小，只有64字节，公钥也很小，只有32字节。 部署情况：<a target="_blank" rel="noopener" href="http://ianix.com/pub/ed25519-deployment.html">http://ianix.com/pub/ed25519-deployment.html</a></li>
</ul>
<h5 id="11-前向安全性"><a href="#11-前向安全性" class="headerlink" title="11. 前向安全性"></a>11. 前向安全性</h5><p>前向安全性( Perfect Forward Secrecy ) <a target="_blank" rel="noopener" href="http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html">http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html</a><br>前向安全性指的是，如果攻击者抓取并保存流量，那么将来私钥泄露后，攻击者也无法利用泄露的私钥解密这些流量。  </p>
<h5 id="12-Diffie-Hellman-密钥交换"><a href="#12-Diffie-Hellman-密钥交换" class="headerlink" title="12. Diffie-Hellman 密钥交换"></a>12. Diffie-Hellman 密钥交换</h5><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange</a><br>在任何一本密码学教材里面都会重点介绍的</p>
<h5 id="13-constant-time-compare"><a href="#13-constant-time-compare" class="headerlink" title="13. constant time compare"></a>13. constant time compare</h5><p>针对Timing attack，<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Timing_attack">http://en.wikipedia.org/wiki/Timing_attack</a> （这种攻击真是脑洞大开！）<br>当一个算法的运行时间和输入数据有关的时候，可以根据运行时间这一信息，破解出密钥等。<br>典型的，比如要验证一个对称签名，如果你用了C库里面的<code>memcmp()</code>，那你就会被timing attack方式攻击。<br>因此，涉及到密码学数据的memcmp，必须要用运行时间和输入无关的函数，比如OpenSSL库里面的<code>CRYPTO_memcmp()</code>   </p>
<p>from: </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.helong.info/blog/2015/06/05/modern-crypto/">https://blog.helong.info/blog/2015/06/05/modern-crypto/</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/byronhe/232d22f1d3dcaa0a20cb">https://gist.github.com/byronhe/232d22f1d3dcaa0a20cb</a></li>
</ul>
<hr>
<h2 id="加密解密算法选择"><a href="#加密解密算法选择" class="headerlink" title="加密解密算法选择"></a>加密解密算法选择</h2><p><img src="/images/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.png" alt="密码学-加密解密"><br>from <a target="_blank" rel="noopener" href="https://bitcoin-on-nodejs.ebookchain.org/4-%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/0-%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/3-%E4%B8%89%E5%BC%A0%E5%9B%BE%E8%AE%A9%E4%BD%A0%E5%85%A8%E9%9D%A2%E6%8E%8C%E6%8F%A1%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E6%8A%80%E6%9C%AF.html">bitcoin-on-nodejs 4-开发实践/0-加密与解密/3-三张图让你全面掌握加密解密技术 </a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hexo.jeremie.moe/2020/07/28/cryptography/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/" data-id="ckwgnkg9t009w7w260fk65ms5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/07/28/cryptography/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%80%E5%B0%8F%E6%97%B6%E5%BF%85%E7%9F%A5/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          密码学一小时必知[2010]
        
      </div>
    </a>
  
  
    <a href="/2020/07/17/archlinux/Archlinux-%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E6%B8%85%E7%90%86-free-disk-space/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Archlinux 磁盘空间清理 free disk space</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AHK/">AHK</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ArchLinux/">ArchLinux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Erlang/">Erlang</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/GalGame/">GalGame</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OpenWRT/">OpenWRT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WinSDK/">WinSDK</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/firefox/">firefox</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/memo/">memo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/notes/">notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E7%81%B5/">人工智灵</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B3%E4%BA%8EBlog/">关于Blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%87%E5%BF%98/">备忘</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%87%E5%BF%98/Notes/">Notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%87%E5%BF%98/%E6%9D%82%E7%89%A9/">杂物</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E7%89%A9/">杂物</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E7%89%A9/Notes/">Notes</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%A8%B1%E8%8A%B1%E5%BA%84%E7%9A%84%E5%AE%A0%E7%89%A9%E5%A5%B3%E5%AD%A9/">樱花庄的宠物女孩</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/">游戏制作</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/Notes/">Notes</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%8A%B1%E4%BD%91%E4%BA%AC%E5%A5%B3%E4%BB%86%E9%98%9F/">花佑京女仆队</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A3%9E%E8%A1%8C/">飞行</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ePost/" rel="tag">ePost</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ePost/" style="font-size: 10px;">ePost</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">五月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">六月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">四月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/11/27/%E4%B8%9A%E4%BD%99%E6%97%A0%E7%BA%BF%E7%94%B5%EF%BC%88HAM%EF%BC%89A%E7%B1%BB%E6%93%8D%E4%BD%9C%E8%AF%81%E8%80%83%E8%AF%95%E6%95%99%E7%A8%8B/">业余无线电（HAM）A类操作证考试教程</a>
          </li>
        
          <li>
            <a href="/2021/11/16/%E6%80%A7%E5%88%AB%E6%88%98%E4%BA%89%E4%B8%89%E5%8D%81%E5%B9%B4/">【转】性别战争三十年</a>
          </li>
        
          <li>
            <a href="/2020/08/18/%E2%80%9C%E9%A3%9E%E8%A1%8C%E9%94%99%E8%A7%89%E2%80%9D%EF%BC%9A%E7%88%86%E5%8F%91%E9%A3%9E%E8%A1%8C%E4%BA%8B%E6%95%85%E6%9C%80%E5%8D%B1%E9%99%A9%E7%9A%84%E5%9B%A0%E7%B4%A0/">“飞行错觉”：爆发飞行事故最危险的因素</a>
          </li>
        
          <li>
            <a href="/2020/08/10/memo/2020-08-10/">2020-08-10</a>
          </li>
        
          <li>
            <a href="/2020/08/07/%E4%BB%80%E4%B9%88%E6%98%AF%E6%83%AF%E6%80%A7%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F/">什么是惯性导航系统？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Jeremie<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives/" class="mobile-nav-link">归档</a>
  
    <a href="/about-blog/" class="mobile-nav-link">关于Blog</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>